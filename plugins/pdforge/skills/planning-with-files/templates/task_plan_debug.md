# Task Plan: Debug {{BUG_NAME}}

## Goal

修复 {{bug 描述}}

## Bug Report

| 字段 | 信息 |
|------|------|
| 症状 | {{用户看到的问题}} |
| 期望行为 | {{应该发生什么}} |
| 实际行为 | {{实际发生什么}} |
| 复现步骤 | {{如何复现}} |
| 错误信息 | {{具体错误}} |
| 影响范围 | {{影响多少用户/功能}} |

## Current Status

| 问题 | 答案 |
|------|------|
| 根因已确定？ | Yes / No |
| 修复方案已确定？ | Yes / No |
| 当前阶段 | Phase {{N}} |

## Phases

- [ ] **Phase 1: 理解 Bug**
  - [ ] 复现问题
  - [ ] 收集错误日志
  - [ ] 确定影响范围
  - **Status:** pending

- [ ] **Phase 2: 定位代码**
  - [ ] 找到相关代码文件
  - [ ] 追踪执行路径
  - [ ] 添加调试日志（如需要）
  - **Status:** pending
  - **Suspect files:**

- [ ] **Phase 3: 根因分析** ← 最关键
  - [ ] 找到根本原因
  - [ ] 理解为什么会出错
  - [ ] 确认不是症状而是根因
  - **Status:** pending
  - **Root cause:**

- [ ] **Phase 4: 设计修复**
  - [ ] 确定修复方案
  - [ ] 评估副作用
  - [ ] 考虑回归风险
  - **Status:** pending

- [ ] **Phase 5: 实施修复**
  - [ ] 编写修复代码
  - [ ] 最小化改动范围
  - **Status:** pending
  - **Files modified:**

- [ ] **Phase 6: 验证**
  - [ ] 确认 bug 已修复
  - [ ] 回归测试
  - [ ] 边界情况测试
  - **Status:** pending

## Investigation Log

> 按时间顺序记录调查过程，**包括死胡同**

| 时间 | 假设 | 验证方法 | 结果 |
|------|------|----------|------|
| | | | ✓/✗ |

## Errors & Dead Ends

> **保留所有失败的尝试！** 这是避免重复走弯路的关键。

| 尝试 | 为什么失败 | 学到了什么 |
|------|-----------|-----------|
| | | |

## Root Cause Analysis

**表面原因**：
{{直接导致错误的代码}}

**深层原因**：
{{为什么会写出这样的代码}}

**根本原因**：
{{系统性问题，如有}}

## Fix Strategy

**方案 A**（推荐）：
- 描述：
- 优点：
- 缺点：
- 风险：

**方案 B**（备选）：
- 描述：
- 优点：
- 缺点：
- 风险：

## Key Learnings

1. {{从这个 bug 学到的教训}}
