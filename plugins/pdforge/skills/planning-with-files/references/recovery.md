# 会话恢复指南

> 当从新会话恢复时如何快速重建上下文

## 5 问检查法

每次从新会话恢复时，必须回答这 5 个问题：

### 问题 1: 目标是什么？

**查看**: `task_plan.md` 的 `## Goal` 部分

**要点**:
- 用一句话复述目标
- 确认目标没有变化
- 如果目标需要调整，先更新 task_plan.md

### 问题 2: 当前在哪个阶段？

**查看**: `task_plan.md` 的 `## Phases` 和 `**当前阶段**`

**要点**:
- 确认当前阶段编号
- 查看该阶段的子任务完成情况
- 状态应该是 `in_progress`

### 问题 3: 上次做到哪里？

**查看**: `progress.md` 的最近一个 Session Log

**要点**:
- 查看上次会话的"完成"和"未完成"
- 查看"会话结束状态"的"下次继续"
- 如果有文件变更，确认文件状态

### 问题 4: 有什么阻塞？

**查看**: `task_plan.md` 的 `## Blockers` 和 `## Errors Encountered`

**要点**:
- 检查是否有未解决的阻塞
- 查看错误记录，避免重复同样的错误
- 如果阻塞已解决，更新状态

### 问题 5: 下一步具体做什么？

**查看**: `task_plan.md` 的 Current Status 表格中的"下一步"

**要点**:
- 确认下一步是具体可执行的动作
- 不是"继续实现"而是"实现 X 函数的 Y 功能"
- 如果不够具体，先细化再开始

---

## 恢复流程

```
1. 读取 task_plan.md
   ↓
2. 回答 5 个问题
   ↓
3. 读取 findings.md（了解已有发现）
   ↓
4. 读取 progress.md 最近的 Session Log
   ↓
5. 在 progress.md 创建新的 Session 记录
   ↓
6. 开始工作
```

---

## 常见恢复场景

### 场景 1: Context 满了被迫 /clear

**特点**: 上次会话可能没有正确保存状态

**处理**:
1. 检查 progress.md 是否有最后的会话记录
2. 如果没有，查看 task_plan.md 的 Current Status
3. 从 Current Status 的"下一步"恢复

### 场景 2: 主动结束会话后恢复

**特点**: 状态应该完整保存

**处理**:
1. 正常执行 5 问检查
2. 直接从"下一步"继续

### 场景 3: 长时间后恢复（隔天/隔周）

**特点**: 可能忘记上下文细节

**处理**:
1. 完整阅读 task_plan.md
2. 完整阅读 findings.md
3. 阅读 progress.md 的所有 Session Log
4. 重新理解整体进度后再继续

---

## 恢复时的反模式

| 反模式 | 为什么错 | 正确做法 |
|--------|---------|---------|
| 不读文件直接开始 | 会忘记之前的决策和发现 | 先执行 5 问检查 |
| 只读 task_plan.md | 会错过详细发现 | 也读 findings.md |
| 假设记得上次状态 | context 清空后记忆是不可靠的 | 以文件为准 |
| 重复已做的工作 | 浪费时间 | 仔细检查 progress.md |
